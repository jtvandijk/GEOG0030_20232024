<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GEOG0030</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-statistics.html" rel="next">
<link href="./02-GIScience.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="assets/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-introduction.html">Foundational Concepts</a></li><li class="breadcrumb-item"><a href="./03-cartography.html">Cartography and Visualisation</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./assets/logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jtvandijk/GEOG0030" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Module overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Foundational Concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Geocomputation: An Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-GIScience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 GIScience and GIS software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-cartography.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">3 Cartography and Visualisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 Programming for Data Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Programming for Spatial Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Core Spatial Analysis</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Advanced Spatial Analysis</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Additional Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 Data Sources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cartography-and-visualisation" id="toc-cartography-and-visualisation" class="nav-link active" data-scroll-target="#cartography-and-visualisation"><span class="header-section-number">3</span> Cartography and Visualisation</a>
  <ul class="collapse">
  <li><a href="#slides-w03" id="toc-slides-w03" class="nav-link" data-scroll-target="#slides-w03"><span class="header-section-number">3.1</span> Lecture slides</a></li>
  <li><a href="#reading-w03" id="toc-reading-w03" class="nav-link" data-scroll-target="#reading-w03"><span class="header-section-number">3.2</span> Reading list</a></li>
  <li><a href="#crime-in-london-i" id="toc-crime-in-london-i" class="nav-link" data-scroll-target="#crime-in-london-i"><span class="header-section-number">3.3</span> Crime in London I</a>
  <ul class="collapse">
  <li><a href="#crime-data" id="toc-crime-data" class="nav-link" data-scroll-target="#crime-data"><span class="header-section-number">3.3.1</span> Crime data</a></li>
  <li><a href="#population-data" id="toc-population-data" class="nav-link" data-scroll-target="#population-data"><span class="header-section-number">3.3.2</span> Population data</a></li>
  <li><a href="#mapping-crime-data" id="toc-mapping-crime-data" class="nav-link" data-scroll-target="#mapping-crime-data"><span class="header-section-number">3.3.3</span> Mapping crime data</a></li>
  </ul></li>
  <li><a href="#assignment-w03" id="toc-assignment-w03" class="nav-link" data-scroll-target="#assignment-w03"><span class="header-section-number">3.4</span> Assignment</a></li>
  <li><a href="#byl-w03" id="toc-byl-w03" class="nav-link" data-scroll-target="#byl-w03"><span class="header-section-number">3.5</span> Before you leave</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jtvandijk/GEOG0030/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="cartography-and-visualisation" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">3</span> Cartography and Visualisation</h1>
<p>This week’s lecture has given you an introduction on how to create a successful map. We further talked about map projections, cartographic conventionsm, and issues faced with the analysis of aggregated data at areal units. The practical component of the week puts some of these learnings into practice as we analyse crime rates in London at two different scales.</p>
<section id="slides-w03" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="slides-w03"><span class="header-section-number">3.1</span> Lecture slides</h2>
<p>The slides for this week’s lecture can be downloaded here: <a href="https://github.com/jtvandijk/GEOG0030/tree/master/slides/w03-geo.pdf">[Link]</a></p>
</section>
<section id="reading-w03" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="reading-w03"><span class="header-section-number">3.2</span> Reading list</h2>
<section id="essential-readings" class="level4">
<h4 class="anchored" data-anchor-id="essential-readings">Essential readings</h4>
<ul>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; Systems, <strong>Chapter 4</strong>: <em>Georeferencing</em>, pp.&nbsp;77-98. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; Systems, <strong>Chapter 11</strong>: <em>Cartography and Map Production</em>, pp.&nbsp;237-252. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
<li>Wong, D. 2009. Modifiable Areal Unit Problem. <em>International Encyclopedia of Human Geography</em> 169-174. <a href="https://doi.org/10.1016/B978-008044910-4.00475-2">[Link]</a></li>
</ul>
</section>
<section id="suggested-readings" class="level4">
<h4 class="anchored" data-anchor-id="suggested-readings">Suggested readings</h4>
<ul>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; systems, <strong>Chapter 12</strong>: <em>Geovisualization</em>, pp.&nbsp;266-289. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
<li>Usery, L. and Seong, J. 2001. All equal-area map projections are created equal, but some are more equal than others. <em>Cartography and Geographic Information Science</em> 28(3): 183-194. <a href="https://doi.org/10.1559/152304001782153053">[Link]</a></li>
</ul>
</section>
</section>
<section id="crime-in-london-i" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="crime-in-london-i"><span class="header-section-number">3.3</span> Crime in London I</h2>
<p>Over the next few weeks, we will explore the spatial patterns of crime across London from a spatial perspective. <a href="https://www.oxfordbibliographies.com/view/document/obo-9780195396607/obo-9780195396607-0123.xml">Reid <em>et al.</em> (2018)</a> suggest:</p>
<blockquote class="blockquote">
<p>Spatial analysis can be employed in both an exploratory and well as a more confirmatory manner with the primary purpose of identifying how certain community or ecological factors (such as population characteristics or the built environment) influence the spatial patterns of crime.</p>
</blockquote>
<p>Against this background, we are actually going to answer a very simple question today: does our perception of crime rates (and its distribution) in London vary at different scales? Here we are looking to test whether we would make the <a href="https://en.wikipedia.org/wiki/Ecological_fallacy">ecological fallacy</a> mistake of assuming patterns at the LSOA level are the same at the Borough level by looking to directly account for the impact of the <a href="https://en.wikipedia.org/wiki/Modifiable_areal_unit_problem">Modifiable Area Unit Problem</a> within our results. Here we will be looking specifically at a specific type of crime: <em>Theft from a person</em>.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The datasets you will create in this practical will be used in other practicals, so make sure to follow every step and export your data to your <code>data</code> folder at the end of the practical.</p>
</div>
</div>
</div>
<section id="crime-data" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="crime-data"><span class="header-section-number">3.3.1</span> Crime data</h3>
<p>For our crime data, we will use data directly from the <strong>Police Data Portal</strong>, which you can find at <a href="https://data.police.uk/">data.polic.uk</a>. This data portal allows you to access and generate tabular data for crime recorded in the UK across different the different police forces since 2017.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>In the United Kingdom, there are 45 territorial police forces (TPF) and 3 special police forces (SPF). Each TPF covers a specific area in the UK (e.g.&nbsp;the <em>West Midlands Police Force</em>), whilst the SPFs are cross-jurisdiction and cover specific types of crime, such as the <a href="https://www.btp.police.uk/">British Transport Police</a>. Therefore, when we want to download data for a specific area, we need to know which police force covers our area interest.</p>
</div>
</div>
</div>
<p>When you look to download crime data for London, there are <strong>two</strong> territorial police forces working within the city and its greater metropolitan area:</p>
<ol type="1">
<li><a href="https://www.met.police.uk/">The Metropolitan Police Force</a>, which covers Greater London.</li>
<li><a href="https://www.cityoflondon.police.uk/">The City of London Police</a>, which covers the City of London.</li>
</ol>
<section id="london-crime-data" class="level4">
<h4 class="anchored" data-anchor-id="london-crime-data">London crime data</h4>
<p>Normally, we would now head to the <strong>Police Data Portal</strong> and download our crime data. However, the manual processing that is required to clean and prepare the data that we need today is too exhaustive and far easier to do using programming, so you can download a pre-filtered spreadsheet below. Unzip the file and copy the <code>csv</code> into a <strong>new</strong> folder in your <code>raw</code> data folder called: <code>crime</code>.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">File</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Theft from persons in 2021</td>
<td style="text-align: left;"><code>csv</code></td>
<td style="text-align: left;"><a href="https://github.com/jtvandijk/GEOG0030/tree/master/data/zip/crime-theft-2021-london.zip">Download</a></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>When mapping the data from the provided longitude and latitude coordinates, it is important to know that these locations represent the approximate location of a crime — not the exact place where it happened. This displacement is introduced on purpose to preserve anonymity of the individuals involved. The process by how this displacement occurs is standardised. There is a list of anonymous map points to which the exact location of each crime is compared against this master list to find the nearest map point. The co-ordinates of the actual crime are then replaced with the co-ordinates of the map point. Each map point is specifically chosen to avoid associating that point with an exact household.</p>
</div>
</div>
</div>
</section>
</section>
<section id="population-data" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="population-data"><span class="header-section-number">3.3.2</span> Population data</h3>
<p>If we want to study a phenomena like crime and aggregate it to an areal unit, we will need to normalise this by some denominator (e.g.&nbsp;population). Why? When we record events created by humans, there is often a population bias: simply, more people in an area will by probability lead to a higher occurrence of said event. Fortunately, we already prepared a 2021 LSOA population dataset <a href="02-GIScience.html#assignment-w02">last week</a>.</p>
<p>In addition to our <strong>LSOA</strong> level dataset, we also need a population dataset for our London <strong>Boroughs</strong> today. We can do this utilising by joining Borough population data to Borough spatial data and creating a <code>Borough2021_London.gpkg</code> file.</p>
<section id="borough-boundaries" class="level4">
<h4 class="anchored" data-anchor-id="borough-boundaries">Borough boundaries</h4>
<p>A lot of data about London is collated by the Greater London Authority (GLA) and made available through the <a href="https://data.london.gov.uk/about/">London Datastore</a>. Whereas some of the data is relatively old, it is a good place to get some data specific to London:</p>
<ol type="1">
<li>Navigate to the London Datastore: <a href="https://data.london.gov.uk/">[Link]</a>.</li>
<li>Click on <strong>Data</strong> in the navigation menu.</li>
<li>Type <em>London Boroughs</em> into the search field.</li>
<li>Download the <code>GeoPackage</code> containing the boundaries of each of London’s 33 Boroughs.</li>
<li>Rename the file to <code>Boroughs_London.gpkg</code> and move it to <code>boundaries</code> folder in your <code>raw</code> data folder.</li>
</ol>
</section>
<section id="borough-population" class="level4">
<h4 class="anchored" data-anchor-id="borough-population">Borough population</h4>
<p>The final data that we need is the total population for each of the London Boroughs in 2021. A good source for this is the 2021 Census again.</p>
<ol type="1">
<li>Navigate to the <em>Nomis</em> portal: <a href="https://www.nomisweb.co.uk/">[Link]</a></li>
<li>Click on <strong>Query data</strong> in the <strong>Data Downloads</strong> panel.</li>
<li>Click on <strong>Census 2021</strong> -&gt; <strong>Topic Summaries</strong>.</li>
<li>Click on <strong>TS007A - Age by five-year age bands</strong>.</li>
<li>Select <strong>Geography</strong> and set <strong>Local authorities: district / unitary (as of April 2023)</strong> to <strong>Some</strong>.</li>
<li>Under <strong>List areas within</strong> select <strong>London</strong>. Click on <strong>Tick all</strong>.</li>
<li>Click on <strong>Download data</strong> at the left hand side of the screen.</li>
<li>Once the data is ready for download, download the file to your computer and save it as <code>LondonBorough2021_population.xlsx</code>.</li>
<li>Open the dataset in your spreadsheet editing software and extract the relevant information: the Borough names and associated population counts. Copy the data that you require into a new <code>csv</code> file and rename the columns as <code>BoroughNames</code> and <code>pop2021</code>.</li>
<li>Now format the <code>pop2021</code> column so that it is recognised as being a <strong>numeric</strong> column.</li>
<li>Save the file as a new <code>csv</code> in your <code>data</code> folder: <code>LondonBorough2021_population.csv</code>.</li>
</ol>
</section>
</section>
<section id="mapping-crime-data" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="mapping-crime-data"><span class="header-section-number">3.3.3</span> Mapping crime data</h3>
<section id="setting-up-a-project" class="level4">
<h4 class="anchored" data-anchor-id="setting-up-a-project">Setting up a project</h4>
<ol type="1">
<li>Start <strong>QGIS</strong></li>
<li>Click on <strong>Project</strong> -&gt; <strong>New</strong>. Save your project as <code>w3-crime-analysis</code>. Remember to save your work throughout the practical.</li>
<li>Before we get started with adding data, we will first set the Coordinate Reference System of our Project. Click on <strong>Project</strong> -&gt; <strong>Properties – CRS</strong>. In the Filter box, type <strong>British National Grid</strong>. Select <strong>OSGB 1936 / British National Grid - EPSG:27700</strong> and click <strong>Apply</strong>. Click <strong>OK</strong>.</li>
</ol>
</section>
<section id="adding-vector-layers" class="level4">
<h4 class="anchored" data-anchor-id="adding-vector-layers">Adding vector layers</h4>
<ol type="1">
<li>Click on <strong>Layer</strong> -&gt; <strong>Add Layer</strong> -&gt; <strong>Add Vector Layer</strong>.</li>
<li>With <strong>File</strong> select as your source type, click on the small three dots button and navigate to your <code>LSOA2021_London.gpkg</code> file in your <code>boundaries</code> folder. Select the file, then click <strong>Add</strong>. You may need to close the box after adding the layer.</li>
</ol>
<p>We now need to create our Borough population spatial layer. To do so, we need to repeat exactly the same process as last week in terms of joining our table data to our spatial layer. You should now be able to do this, so we will not provide you with detailed instructions. Remember, you need to:</p>
<ul>
<li>Load the respective Borough dataset as a Vector Layer found in your <code>raw/boundaries/</code> data folder: <code>Boroughs_London.gpkg</code>.</li>
<li>Load the respective population dataset that you just created as a <strong>Delimited Text File Layer</strong>. Remember the settings, including no geometry!</li>
<li>Join the two datasets together using the <strong>Join</strong> tool in the Borough dataset <strong>Properties</strong> box. Remember which fields to use, which to add, and to remove the prefix.</li>
<li>Export your joined dataset into a new dataset within your <code>data</code> folder as: <code>Boroughs_London_Pop2021.gpkg</code>.</li>
<li>Make sure this dataset is loaded into your <strong>Layers</strong> / added to the map.</li>
<li>Remove the original Borough and population data layers.</li>
</ul>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Because the population file that we downloaded does not contain Borough codes, we need to use the Borough names to join the two files together. Whilst it works here and we can easily manually check whether the join was successful because there are only 33 records, codes are preferred as there is much less room for error and incomplete joins. This means it is often worth it to spend a bit more time and find these codes over relying on names.</p>
</div>
</div>
</div>
</section>
<section id="adding-point-layers" class="level4">
<h4 class="anchored" data-anchor-id="adding-point-layers">Adding point layers</h4>
<p>We will now load and map our crime data. We will load this data using the <strong>Delimited Text File Layer</strong> option you would have used just now to load the Borough population, but this time we will be adding point coordinates to map our crime data as points.</p>
<ol type="1">
<li>Click on <strong>Layer</strong> -&gt; <strong>Add Layer</strong> -&gt; <strong>Add Delimited Text File Layer</strong>.
<ul>
<li>Click on the three dots button next to <strong>File Name</strong> and navigate to your <code>crime-theft-2021-london.csv</code> in your <code>raw/crime</code> folder.</li>
<li>Click on the <code>.csv</code> file of this dataset and click <strong>Open</strong>.</li>
<li>Your file format should be set to <code>csv</code>. In <strong>Record and Fields Options</strong> tick <code>Decimal separator is comma</code>, <code>First record has field names</code>, <code>Detect field types</code> and <code>Discard empty fields</code>.</li>
<li>Under <strong>Geometry Definition</strong>, select <code>Point coordinates</code> and set the <strong>X field</strong> to <code>Longitude</code> and the <strong>Y field</strong> to <code>Latitude</code>. The <strong>Geometry CRS</strong> should be: <code>EPSG:4326 - WGS84</code>. Click <strong>Add</strong>.</li>
</ul></li>
</ol>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>When you click <strong>Add</strong>, you should have gotten a pop-up from QGIS asking about transformations. Transformations are algorithms that convert data from one CRS to another. QGIS knows that the <strong>Project CRS</strong> is <strong>British National GRid</strong> but the <strong>Layer</strong> you are trying to add has a <strong>WGS84</strong> CRS. QGIS is asking you what transformation it should use to project the Layer in the Project CRS. This is one of the key strengths of QGIS: it can project data ‘on the fly’. What this means is that QGIS will automatically convert all Layers to the <strong>Project CRS</strong> once it knows which transformation you would like to use so that they will all be rendered in the correct position with respect to each other. More details on this can be found in QGIS’ <a href="https://docs.qgis.org/3.28/en/docs/user_manual/working_with_projections/working_with_projections.html">user manual section on working with projections</a>.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Click <strong>OK</strong> to accept QGIS’ suggested on-the-fly projection. You should now see your crime dataset displayed on the map canvas.</li>
</ol>
<div class="cell" data-hash="03-cartography_cache/html/fig-borough-crime_aa172d8d2809d34319d4e1e77be97126">
<div class="cell-output-display">
<div id="fig-borough-crime" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w03/crime-borough.png" class="img-fluid figure-img" width="776"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Borough map with crime data. <a href="https://jtvandijk.github.io/GEOG0030/images/w03/crime-borough.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>We can test the temporary nature of the projection by looking at the CRS of the <code>crime-theft-2021-london</code> layer. Right-click on the layer then select <strong>Properties</strong> -&gt; <strong>Information</strong> and then look at the associated CRS. You should see that the CRS of the layer is still <code>WGS84</code>.</li>
</ol>
<p>We want to make sure our analysis is as accurate and efficient as possible, so it is best to reproject our data into the <strong>same CRS</strong> as our administrative datasets, i.e.&nbsp;British National Grid. This also means we will have the dataset to use in other projects, just in case.</p>
<ol start="4" type="1">
<li>Back in the main QGIS window, click on <strong>Vector</strong> -&gt; <strong>Data Management Tools</strong> -&gt; <strong>Reproject Layer</strong>. Fill in the parameters as follows:
<ul>
<li><strong>Input Layer:</strong> <code>crime-theft-2021-london</code></li>
<li><strong>Target CRS:</strong> <code>Project CRS: EPSG: 27700</code></li>
<li><strong>Reprojected:</strong> Click on the three buttons and <strong>Save to GeoPackage</strong> to create a new data file.</li>
<li><strong>Save</strong> it in your <code>raw/crime</code> folder as <code>crime-theft-2021-london-prj.gpkg</code>, using <code>theft2021</code> as <strong>Layer Name</strong>.</li>
<li>Click <strong>Run</strong>. You should now see the new data layer added to your project. You can now close the <strong>Reproject Layer</strong> tool.</li>
</ul></li>
<li>You can now also remove the original <code>crime-theft-2021-london</code> dataset, only keeping the reprojected version.</li>
</ol>
</section>
<section id="counting-points-in-polygons" class="level4">
<h4 class="anchored" data-anchor-id="counting-points-in-polygons">Counting points-in-polygons</h4>
<p>The next step of our analysis involves assigning the crime point data to our administrative geographies. We will use the <code>Count Points in Polygons</code> in the <code>Analysis</code> toolset to count how many crimes have occurred in our <strong>LSOAs</strong> and our <strong>Boroughs</strong>. We will then have a count statistic that we need to normalise by population data to create a <strong>crime rate</strong> statistic.</p>
<ol type="1">
<li>Click on <strong>Vector</strong> -&gt; <strong>Analysis Tools</strong> -&gt; <strong>Count Points in Polygons</strong>.</li>
<li>Within the toolbox, select the parameters as follows:
<ul>
<li><strong>Polygons:</strong> <code>Boroughs_London_Pop2021</code></li>
<li><strong>Points:</strong> <code>theft2021</code> [Note how both our data layers state the same CRS.]</li>
<li>No weight field or class field</li>
<li><strong>Count field names:</strong> <code>theft2021</code></li>
<li>Click on the three dot button and <strong>Save to GeoPackage:</strong> <code>output</code> -&gt; <code>Borough2021_crime.gpkg</code>, with <code>borough-theft2021</code> as <strong>Layer Name</strong>.</li>
</ul></li>
<li>Click <strong>Run</strong> and <strong>Close</strong> the box. You should now see an <code>Output</code> layer added to your Layers box. Rename the layer to <code>borough-theft2021</code>.</li>
<li>Right-click on the <code>borough-theft2021</code> layer and open the <strong>Attribute Table</strong>. You should now see a <code>theft2021</code> column next to your <code>pop2021</code> column. You can look through the column to see the different levels of crime in the each Borough. You can also sort the column, from small to big, big to small, like you would do in a spreadsheet software.</li>
</ol>
<p>Whilst it is great that we have got our <code>theft2021</code>, what we actually need is a <strong>crime rate</strong> to account for the different population sizes across the Boroughs. To get our <strong>crime rate</strong> statistic, we are going to do our first bit of table manipulation in QGIS.</p>
<ol start="5" type="1">
<li>With the <strong>Attribute Table</strong> of your <code>borough-theft2021</code> layer still open, click on the <strong>pencil</strong> icon at the top left corner. This pencil switches on the <strong>Editing</strong> mode.</li>
</ol>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <em>Editing mode</em> allows you to edit both the <strong>Attribute Table</strong> values and the <strong>geometry</strong> of your data. When it comes to the <strong>Attribute Table</strong>, it means you can directly edit existing values in the table <strong>or</strong> create and add new fields to the table. Whilst you can actually do the latter outside of the <em>Editing mode</em>, this <em>Editing mode</em> means you can reverse any edits you make and they are not permanent just in case you make a mistake. Using the <em>Editing mode</em> is the safest approach to editing your table, however, it might not always be the approach you use when generating new fields.</p>
</div>
</div>
</div>
<ol start="6" type="1">
<li>Whilst in the <em>Editing mode</em>, click on <strong>New Field</strong> button (hotkeys: <code>ctrl + w</code> or <code>cmd + w</code> and fill in the <strong>Field Parameters</strong> as follows:
<ul>
<li><strong>Name:</strong> <code>crime-rate</code></li>
<li><strong>Comment:</strong> <em>leave blank</em></li>
<li><strong>Type:</strong> Decimal number</li>
</ul></li>
<li>Click <strong>OK</strong>. You should now see a new field added to our <strong>Attribute Table</strong>.</li>
</ol>
<p>The empty field has <em>NULL</em> populated for each row, so we need to find a way to give our Boroughs some crime rate data. To do this, we will calculate a simple <strong>Crime Rate</strong> using the <strong>Field Calculator</strong> tool provided by QGIS within the <strong>Attribute Table</strong>. We will create a crime rate that details the number of crimes per 10,000 people in the Borough.</p>
<ol start="8" type="1">
<li>Whilst still in the <em>Editing mode</em>, click on the <strong>Abacus</strong> button (<code>ctrl + i</code> or <code>cmd + i</code>), which is known as the <strong>Field Calculator</strong>.</li>
<li>In the <strong>Field Calculator</strong> window:
<ul>
<li>Check the <strong>Update existing field</strong> box.</li>
<li>Use the drop-down to select the <code>crime-rate</code> field.</li>
<li>In the Expression editor, add the following expression: <code>( "theft2021" / "pop2021" ) * 10000</code></li>
<li>Once done, click <strong>OK</strong>.</li>
</ul></li>
<li>Click on the <strong>Save</strong> button to save these edits. Click again on the <strong>Pencil</strong> button to exit <em>Editing mode</em>.</li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <code>crime-rate</code> is stored as a decimal as this is required for the calculation to succeed, but ultimately you cannot have half a crime. You can transform the decimal number to an <code>integer</code> by forcing the <code>crime-rate</code> column to a new field using the same <strong>Field Calculator</strong>. Instead of ticking the <strong>Update existing field</strong> box you would now keep the <strong>Create a new field</strong> box ticked. Name the new field <code>crime-rate-int</code>, make sure the <strong>Output field type</strong> is set to <code>Whole number (integer)</code>, and use the following expression to create a new field with an integer value: <code>to_int("crime-rate")</code>. Save your changes by clicking on the <strong>Save</strong> button.</p>
</div>
</div>
</div>
<ol start="11" type="1">
<li>We now have our Borough crime rate dataset ready for mapping. We just now need to repeat this process to have our <strong>LSOA</strong> dataset. So, add the <code>LSOA2021_London.gpkg</code> file to your project and repeat the above process to create a <code>crime-rate</code> and <code>crime-rate-int</code> column within the <strong>LSOA</strong> dataset as well. After reordering some of the layers, your screen should look something like this:</li>
</ol>
<div class="cell" data-hash="03-cartography_cache/html/fig-crime-different-layers_15d29b14dac64f072fe142082a64dc4e">
<div class="cell-output-display">
<div id="fig-crime-different-layers" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w03/crime-borough-lsoa.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;2: QGIS view containing crime data layers for both the London Boroughs and LSOAs. <a href="https://jtvandijk.github.io/GEOG0030/images/w03/crime-borough-lsoa.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="mapping-crime-data-1" class="level4">
<h4 class="anchored" data-anchor-id="mapping-crime-data-1">Mapping crime data</h4>
<p>Now you have both datasets ready, it is time to style the maps. Remember to use the <strong>Properties</strong> box to symbolise your mapss. Think through using an appropriate colour scheme, perhaps <a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">have a look at the online colorbrewer 2.0 for inspiration</a> if you do not want to use the default settings. Once you are happy with their symbolisation, we can turn them into proper publishable maps using QGIS’s <strong>Print Layout</strong>.</p>
<div class="cell" data-hash="03-cartography_cache/html/fig-map-styled_4d5954d334173c6363ea4f441c9db781">
<div class="cell-output-display">
<div id="fig-map-styled" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w03/map-styled.png" class="img-fluid figure-img" width="776"></p>
<figcaption class="figure-caption">Figure&nbsp;3: An example of how your maps could have been symbolised. <a href="https://jtvandijk.github.io/GEOG0030/images/w03/map-styled.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>If you have used ArcMap before, <strong>Print Layout</strong> is similar to switch the view of your map canvas to a print layout within the main window but in QGIS’s case, it loads up a new window.</p>
</div>
</div>
</div>
<p>From the main QGIS window, click on <strong>Project</strong> -&gt; <strong>New Print Layout</strong>. In the small box that first appears, call your new print layout: <code>crime-map-borough-lsoa</code>. A new window should open up that shows a blank canvas. On the <strong>left-hand</strong> side of the window, you will find buttons to add print layout items: the current QGIS map canvas, text labels, images, legends, scale bars, basic shapes, arrows, attribute tables and HTML frames. In this toolbar you also find buttons to navigate, zoom in on an area and pan the view on the layout a well as buttons to select any layout item and to move the contents of the map item.</p>
<p>On the <strong>right-hand</strong> side of the window, you will find two set of panels. The upper one holds the panels <em>Items</em> and <em>Undo History</em> and the lower holds the panels <em>Layout</em>, <em>Item properties</em> and <em>Atlas generation</em>. Today, we are most interested in the bottom panel as <em>Layout</em> will control the overall look of our map, whilst <em>Item properties</em> will allow us to customise the elements, such as title or legend, that we may add to our map.</p>
<p>In the <strong>bottom part</strong> of the window, you can find a status bar with mouse position, current page number, a combo box to set the zoom level and the number of selected items if applicable. In the <strong>upper part</strong> of the window, you can find menus and other toolbars. All print layout tools are available in menus and as icons in a toolbar.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Working with maps in the Print Layout is simple but it can be a little fiddly and, to make more complicated maps, requires you to understand how to use certain aspects of Print Layout, such as locking items. If you get stuck, have a look at the <a href="https://docs.qgis.org/3.28/en/docs/training_manual/map_composer/map_composer.html">training manual</a> or the detailed <a href="https://docs.qgis.org/3.28/en/docs/user_manual/print_composer/index.html">documentation</a>.</p>
</div>
</div>
</div>
<p>To start with creating a map, you use the <strong>Add Map</strong> tool to draw a box in which a snapshot of the <strong>current active</strong> map you have displayed in your QGIS main window will be loaded.</p>
<ol type="1">
<li>Click on the <strong>Add Map</strong> tool and draw a box in the first half of our map to load our current map. Note, you can move your map around and resize the box simply by clicking on it as you would in Word etc.</li>
</ol>
<div class="cell" data-hash="03-cartography_cache/html/fig-map-layout_22d3ddf79c45006b0576920a13349087">
<div class="cell-output-display">
<div id="fig-map-layout" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w03/map-layout.png" class="img-fluid figure-img" width="740"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Current active map in the <strong>Print Layout</strong>. <a href="https://jtvandijk.github.io/GEOG0030/images/w03/map-layout.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li>With your map selected, head to the <strong>Items Properties</strong> panel and look for the <strong>Scale</strong> parameter.
<ul>
<li>Here we can manually edit the <strong>scale</strong> of our map to find the right zoom level.</li>
<li>Have a go at entering different values and see what level you think suits the size of your map.</li>
<li>Keep a note of the scale, as we will need this for the second map we will add to our map layout - our LSOA map.</li>
<li>Next, in the same panel, if you would like, you can add a frame to your map - this will draw a box (of your selected formatting) around the current map.</li>
<li>In the same panel, note down the size of your map - we want to make sure the next map we add is of the same size.</li>
<li>Note, if you need to move the position of the map within the box, look for the <strong>Move Item Content</strong> tool on the left-hand side toolbar.</li>
<li>Once you are done, finally click on the <strong>Lock Layers</strong> and <strong>Lock Style for layers.</strong></li>
</ul></li>
</ol>
<p>By locking the Layers (and their symbology) in our map, it means we can change our data/map in our main QGIS window without changing the map in the <strong>Print Layout</strong> - as we will see in a minute when adding our Borough crime rate map. If we do not lock our layers, our map would automatically update to whatever is next displayed in the main QGIS window.</p>
<ol start="3" type="1">
<li>Click on the <strong>Add Legend</strong> tool and again, draw a box on your map in which your legend will appear.
<ul>
<li>As you will see, your Legend auto-generates an entry for every layer in our Layers box in the main QGIS application:</li>
<li>In <strong>Item Properties</strong>, uncheck <strong>auto-update</strong> - this stops QGIS automatically populating your legend and enables you to customise your legend.</li>
<li>First, let us rename our layer in the legend to: <strong>Borough Crime Rate (per 10,000 people)</strong>.</li>
<li>Next, we want to remove all other Layers, using the <strong>-</strong> (minus) button</li>
<li>We can also customise the Legend further, including type, size and alignment of font. Go ahead and style your legend as you would prefer.</li>
<li>Move the Legend to an appropriate part of the layout near your Borough crime rate map - resize if necessary.</li>
</ul></li>
</ol>
<div class="cell" data-hash="03-cartography_cache/html/fig-autolegend_1f00badb19c50df4e70d13ce12ba9b7e">
<div class="cell-output-display">
<div id="fig-autolegend" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w03/autolegend.png" class="img-fluid figure-img" width="740"></p>
<figcaption class="figure-caption">Figure&nbsp;5: The automatically generated legend for your map. <a href="https://jtvandijk.github.io/GEOG0030/images/w03/autolegend.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Now we are finished with the Borough map, we want to make sure we do not change any aspect of its layout. To do so, we need to lock both the map layer and legend in the <strong>Items</strong> panel. This prevents us accidentally moving items in our layout. Note, this is different to locking your layers in the <strong>Items Properties</strong> as we did earlier.</p>
<ol start="4" type="1">
<li>In the <strong>Items</strong> panel, click the <strong>Lock</strong> check box for both our map layer and legend.</li>
<li>In the main QGIS window, uncheck your <code>borough-theft2021</code> layer and make sure your <code>lsoa-theft2021</code> layer is now visible.</li>
<li>Return to the <strong>Print Layout</strong> window annd repeat the process above of adding a map to the window. This time you should see your LSOA map loaded in the box (and you should see <strong>no</strong> changes to your Borough map).
<ul>
<li>Place your LSOA map next to your LSOA map - use the snap grids to help.</li>
<li>Set your LSOA map to the <strong>same zoom level</strong> as your Borough map.</li>
<li>Make sure your LSOA map is the <strong>same size</strong> as your Borough map.</li>
<li>Add a frame if you want.</li>
<li>Lock your layer and its symbology in the <strong>Items Properties</strong> once ready and the lock your layer in the <strong>Items</strong> panel.</li>
</ul></li>
</ol>
<p>We now just need to add a second legend for our Borough map.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>If we had <strong>standardised</strong> our values across our two maps, then we would only need to use one legend. However, in this case, as there are large differences in the value ranges, we need to have two legends.</p>
</div>
</div>
</div>
<ol start="7" type="1">
<li>Repeat the process as above to add a Legend for our LSOA map.
<ul>
<li>Remember to re-title the legend to make it more legible/informative.</li>
<li>Match the same formatting for a clean look.</li>
</ul></li>
<li>Once complete, <strong>lock these two items</strong> in the <strong>Items</strong> panel as well.</li>
<li>Now we have our two maps ready, we can add our <strong>main map elements</strong>. Using the tools on the left-hand tool bar:
<ul>
<li>Add a <strong>scale bar</strong>: use the <strong>Item Properties</strong> to adjust the <strong>Style</strong>, <strong>number of segments</strong>, <strong>font</strong>, etc.</li>
<li>Add a <strong>north arrow</strong>: draw a box to generate the arrow and then use the <strong>Item Properties</strong> to adjust..</li>
<li>Add a <strong>title</strong> at the top of the page, and subtitles above the individual maps.</li>
<li>Finally add a box detailing our data sources, you can copy and paste the following: <em>Contains National Statistics data © Crown copyright and database right [2021] (Open Government Licence). Contains Ordnance Survey data © Crown copyright and database right [2021]. Crime data obtained from data.police.uk (Open Government Licence).</em></li>
</ul></li>
</ol>
<p>Once you have added these properties in, you should have something that looks a little like this:</p>
<div class="cell" data-hash="03-cartography_cache/html/fig-final-map_dfb3fc91d953d00a0e21503fccf44689">
<div class="cell-output-display">
<div id="fig-final-map" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w03/london-crime-rate.png" class="img-fluid figure-img" width="740"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Crime rates in London Boroughs and LSOAs. <a href="https://jtvandijk.github.io/GEOG0030/images/w03/london-crime-rate.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>The only thing outstanding is to export our map to a file. Go to <strong>Layout</strong> -&gt; <strong>Export as Image</strong> and then save it as <code>London-2021-crime-rate.png</code>.</p>
</section>
</section>
</section>
<section id="assignment-w03" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="assignment-w03"><span class="header-section-number">3.4</span> Assignment</h2>
<ol type="1">
<li>Looking at the maps you have created, how does your perception of crime (and its distribution) in London vary at different scales?</li>
<li>At the moment, we have looked at the crime rate as a relative amount. We therefore use a sequential colour scheme that shows, predominantly, where the crime rate is the highest. Alternatively, we could use a diverging colour scheme that could show us where the crime rate is lower and/or higher than a critical mid-point, such as the average crime rate across the Boroughs and LSOAs. Create a map of crime in London, at both the Borough and LSOA levels that shows for each of these administrative geographies the <strong>percentage difference</strong> from the overall mean crime rate.</li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>You will need to start by calculating the average crime rate for both datasets and subsequently calculate the difference from these values for each geography.</li>
<li>All calculations can be done using the field calculator in QGIS, but you might have to think through writing the right expression.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="byl-w03" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="byl-w03"><span class="header-section-number">3.5</span> Before you leave</h2>
<p><a href="https://www.youtube.com/watch?v=3wxyN3z9PL4">That is us all done</a>. Remember to save your project. And remember the reading list.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-GIScience.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">GIScience and GIS software</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-statistics.html" class="pagination-link">
        <span class="nav-page-text">Programming for Data Analysis</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Course material by <a href="https://www.mappingdutchman.com">Justin van Dijk</a>. Available under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>