<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>giscience</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-cartography.html" rel="next">
<link href="./01-introduction.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="assets/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-introduction.html">Foundational Concepts</a></li><li class="breadcrumb-item"><a href="./02-GIScience.html">GIScience and GIS software</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./assets/logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jtvandijk/GEOG0030" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Module overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Foundational Concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Geocomputation: An Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-GIScience.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2 GIScience and GIS software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-cartography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Cartography and Visualisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 Programming for Data Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Programming for Spatial Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Additional Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 Data Sources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#giscience-and-gis-software" id="toc-giscience-and-gis-software" class="nav-link active" data-scroll-target="#giscience-and-gis-software"><span class="header-section-number">2</span> GIScience and GIS software</a>
  <ul class="collapse">
  <li><a href="#slides-w01" id="toc-slides-w01" class="nav-link" data-scroll-target="#slides-w01"><span class="header-section-number">2.1</span> Lecture slides</a></li>
  <li><a href="#reading-w02" id="toc-reading-w02" class="nav-link" data-scroll-target="#reading-w02"><span class="header-section-number">2.2</span> Reading list</a></li>
  <li><a href="#simple-digitisation-of-spatial-features" id="toc-simple-digitisation-of-spatial-features" class="nav-link" data-scroll-target="#simple-digitisation-of-spatial-features"><span class="header-section-number">2.3</span> Simple digitisation of spatial features</a></li>
  <li><a href="#population-change-in-london" id="toc-population-change-in-london" class="nav-link" data-scroll-target="#population-change-in-london"><span class="header-section-number">2.4</span> Population change in London</a>
  <ul class="collapse">
  <li><a href="#w02-scene" id="toc-w02-scene" class="nav-link" data-scroll-target="#w02-scene"><span class="header-section-number">2.4.1</span> Setting the scene</a></li>
  <li><a href="#w02-finding" id="toc-w02-finding" class="nav-link" data-scroll-target="#w02-finding"><span class="header-section-number">2.4.2</span> Finding data</a></li>
  <li><a href="#w01-housekeeping" id="toc-w01-housekeeping" class="nav-link" data-scroll-target="#w01-housekeeping"><span class="header-section-number">2.4.3</span> Housekeeping</a></li>
  <li><a href="#w02-download-spatial" id="toc-w02-download-spatial" class="nav-link" data-scroll-target="#w02-download-spatial"><span class="header-section-number">2.4.4</span> Downloading spatial data</a></li>
  <li><a href="#w02-download-population" id="toc-w02-download-population" class="nav-link" data-scroll-target="#w02-download-population"><span class="header-section-number">2.4.5</span> Downloading population data</a></li>
  <li><a href="#w02-cleaning" id="toc-w02-cleaning" class="nav-link" data-scroll-target="#w02-cleaning"><span class="header-section-number">2.4.6</span> Cleaning data</a></li>
  <li><a href="#mapping-population-data" id="toc-mapping-population-data" class="nav-link" data-scroll-target="#mapping-population-data"><span class="header-section-number">2.4.7</span> Mapping population data</a></li>
  <li><a href="#exporting-map-for-visual-analysis" id="toc-exporting-map-for-visual-analysis" class="nav-link" data-scroll-target="#exporting-map-for-visual-analysis"><span class="header-section-number">2.4.8</span> Exporting map for visual analysis</a></li>
  </ul></li>
  <li><a href="#assignment-w02" id="toc-assignment-w02" class="nav-link" data-scroll-target="#assignment-w02"><span class="header-section-number">2.5</span> Assignment</a></li>
  <li><a href="#byl-w02" id="toc-byl-w02" class="nav-link" data-scroll-target="#byl-w02"><span class="header-section-number">2.6</span> Before you leave</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jtvandijk/GEOG0030/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="giscience-and-gis-software" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">2</span> GIScience and GIS software</h1>
<p>This week’s lecture introduced you to foundational concepts associated with GIScience and GIS software, with particular emphasis on the representation of spatial data and sample design. Out of all our foundational concepts you will come across in the next four weeks, this is probably the most substantial to get to grips with and has both significant theoretical and practical aspects to its learning. The practical component of the week puts some of these learnings into practice, starting with a short digitisation exercise followed by a simple visualisation of London’s population in the Census years of 2011 and 2021.</p>
<section id="slides-w01" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="slides-w01"><span class="header-section-number">2.1</span> Lecture slides</h2>
<p>The slides for this week’s lecture can be downloaded here: <a href="https://github.com/jtvandijk/GEOG0030/tree/master/slides/w02-geo.pdf">[Link]</a></p>
</section>
<section id="reading-w02" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="reading-w02"><span class="header-section-number">2.2</span> Reading list</h2>
<section id="essential-readings" class="level4">
<h4 class="anchored" data-anchor-id="essential-readings">Essential readings</h4>
<ul>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; Systems, <strong>Chapter 2</strong>: <em>The Nature of Geographic Data</em>. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; Systems, <strong>Chapter 3</strong>: <em>Representing Geography</em>. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
<li>Longley, P. <em>et al.</em> 2015. Geographic Information Science &amp; Systems, <strong>Chapter 7</strong>: <em>Geographic Data Modeling</em>. <a href="https://ucl.rl.talis.com/link?url=https%3A%2F%2Fapp.knovel.com%2Fhotlink%2Ftoc%2Fid%3AkpGISSE001%2Fgeographic-information-science%3Fkpromoter%3Dmarc&amp;sig=e437927b963cc591dcb65491eccdd3869cc31aef80e1443cb2ba12d8f3bb031a">[Link]</a></li>
</ul>
</section>
<section id="suggested-readings" class="level4">
<h4 class="anchored" data-anchor-id="suggested-readings">Suggested readings</h4>
<ul>
<li>Goodchild, M. and Haining, R. 2005. GIS and spatial data analysis: Converging perspectives. <em>Papers in Regional Science</em> 83(1): 363–385. <a href="https://doi.org/10.1007/s10110-003-0190-y">[Link]</a></li>
<li>Schurr, C., Müller, M. and Imhof, N. 2020. Who makes geographical knowledge? The gender of Geography’s gatekeepers. <em>The Professional Geographer</em> 72(3): 317-331. <a href="https://doi.org/10.1080/00330124.2020.1744169">[Link]</a></li>
<li>Yuan, M. 2001. Representing complex geographic phenomena in GIS. <em>Cartography and Geographic Information Science</em> 28(2): 83-96. <a href="https://doi.org/10.1559/152304001782173718">[Link]</a></li>
</ul>
</section>
</section>
<section id="simple-digitisation-of-spatial-features" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="simple-digitisation-of-spatial-features"><span class="header-section-number">2.3</span> Simple digitisation of spatial features</h2>
<p>To get spatial features in a digital form, they need to be digitised. It is as simple as that. Let’s take a quick look in this first part of the practical at a straightforward example of digitising the river Thames in London.</p>
<div class="cell" data-hash="02-GIScience_cache/html/fig-digitise_c0afca359cc62c2594d6c338b7e0d6d1">
<div class="cell-output-display">
<div id="fig-digitise" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/river-thames.png" class="img-fluid figure-img" width="776"></p>
<figcaption class="figure-caption">Figure&nbsp;1: The river Thames. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/river-thames.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>We will use a very simple online tool that allows us to create digital spatial data and export these data for use in other software programmes:</p>
<ol type="1">
<li>Head to <a href="http://geojson.io/#map=12/51.5170/-0.1030">geojson.io</a>.</li>
<li>In the bottom left-hand corner, select <em>Satellite Streets</em> as your map option.</li>
<li>Next, click on the <code>Draw Linestring</code> tool which you can find on the right hand side of the screen. You can hover over the icons to get the names of each tool.</li>
<li>Now digitise the river Thames. Simply click from a starting point on the left- or right-hand side of the map, and digitise the river.</li>
<li>Once you are done, double-click your final point to end your line.</li>
<li>You can click on the line and select <em>Info</em> in the pop-up screen to find out how long the line is.</li>
<li>You can export your data using the <em>Save</em> menu.</li>
</ol>
</section>
<section id="population-change-in-london" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="population-change-in-london"><span class="header-section-number">2.4</span> Population change in London</h2>
<p>The second part of this practical will introduces you to <strong>Attribute Joins</strong> and <a href="https://en.wikipedia.org/wiki/Choropleth_map">choropleth maps</a>. You will be using different types of <em>joins</em> throughout this practical, this module in general, and probably the rest of your career, so it is incredibly important that you understand how these work.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The datasets you will create in this practical will be used in coming week’s practicals, so make sure to follow every step and save your data carefully.</p>
</div>
</div>
</div>
<p>When using spatial data, there is generally a specific workflow that you will need to go through and, believe it or not, the majority of this is not actually focused on analysing your data. One of the most often-quoted GIS-related ‘facts’ is that anyone working with spatial data will spend 80% of their time simply finding, retrieving, managing and processing the data before any analysis can be done.</p>
<p>One of the reasons behind this is that the data you often need to use is almost never in the format that you require for analysis. Instead, we need to go and find the raw datasets and create the data layers that we want ourselves.</p>
<p>A typical spatial analysis workflow typically will look something like this:</p>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Step</th>
<th style="text-align: left;">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>identify</code></td>
<td style="text-align: left;">Think about the data you need to complete your analysis.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>find</code></td>
<td style="text-align: left;">Find the data that matches your requirements.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>download</code></td>
<td style="text-align: left;">Store the data on your computer in the right folder.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>clean</code></td>
<td style="text-align: left;">Assess whether the data needs pre-processing before moving to QGIS or R.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>load</code></td>
<td style="text-align: left;">Load the <code>cleaned</code> data into QGIS, R, or software of choice.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>process</code></td>
<td style="text-align: left;">Prepare the data so that they are ready for analysis (e.g.&nbsp;joining, aggregating).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>analyse</code></td>
<td style="text-align: left;">Execute the actual analysis that you set out to do.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>visualise</code></td>
<td style="text-align: left;">Create graphs and maps where appropriate.</td>
</tr>
</tbody>
</table>
<p>As you can see, the analysis and visualisation parts only make up the last steps of the workflow and instead, the workflow is very top-heavy with data management.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Very often in GIS-related courses you will be given pre-processed datasets. Because data management is an essential part of your workflow, we will clean the majority of our data from the get-go. This will help you understand the processes that you will need to go through in the future as you search for and download your own data before loading it into your GIS environment.</p>
</div>
</div>
</div>
<section id="w02-scene" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="w02-scene"><span class="header-section-number">2.4.1</span> Setting the scene</h3>
<p>In this part of the practical, we will investigate how the population in London has changed over time. Understanding population change over time and space is spatial analysis at its most fundamental. We can understand a lot just from where population is growing or decreasing, including thinking through the impacts of these changes on the provision of housing, education, health and transport infrastructure. Today we will look at population in London in the Census years of 2011 and 2021 at the so-called <strong>Lower Super Output Area</strong> (LSOA) geography level (see @#02-download-spatial below for some details on Administrative Geographies).</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We will use the population dataset we create today to <em>normalise</em> other datasets in the module. Why? When we record events created by humans, there is often a population bias: simply, more people in an area will by probability lead to a higher occurrence of said event, such as crime. We will look at this in greater detail next week.</p>
</div>
</div>
</div>
</section>
<section id="w02-finding" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="w02-finding"><span class="header-section-number">2.4.2</span> Finding data</h3>
<p>In the UK, finding authoritative data on population and <em>Administrative Geography</em> boundaries is increasingly straightforward. Over the last decade, the UK government has opened up many of its datasets as part of an <strong>Open Data</strong> precedent that began in 2010 with the creation of <a href="https://www.data.gov.uk">data.gov.uk</a> and the Open Government Licence (the terms and conditions for using data).</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://www.data.gov.uk">Data.gov.uk</a> is the UK government’s central database that contains open data that the central government, local authorities, and public bodies publish. This includes, for example, aggregated census and health data. In addition to this central database, there are other authoritative databases run by the government and/or respective public bodies that contain either a specific type of data (e.g.&nbsp;Census data, crime data) or a specific collection of datasets (e.g.&nbsp;health data from the NHS, data related to London). Some portals are less up-to-date than others, so it is wise to double-check with the ‘originators’ of the data to see if there are more recent versions.</p>
</div>
</div>
</div>
<p>For our practical, we will access data from two authoritative data portals:</p>
<ul>
<li>For our administrative boundaries, we will download the <strong>spatial</strong> data through the <em>Open Geography Portal</em>.</li>
<li>For our population data, we will download <strong>attribute</strong> data directly from the <em>Office of National Statistics (ONS)</em>.</li>
</ul>
</section>
<section id="w01-housekeeping" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="w01-housekeeping"><span class="header-section-number">2.4.3</span> Housekeeping</h3>
<p>Before we download our data, it is important to establish an organised file systems that we will use throughout the module. Create a <code>GEOG0030</code> folder in your <code>Documents</code> folder on your computer and within your <code>GEOG0030</code> folder, create the following subfolders:</p>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Folder name</th>
<th style="text-align: left;">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>raw</code></td>
<td style="text-align: left;">To store all your raw data files that have not yet been cleaned and processed.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;">To store data files that have been cleaned and processed.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>output</code></td>
<td style="text-align: left;">To store all your final output data files and maps.</td>
</tr>
</tbody>
</table>
</section>
<section id="w02-download-spatial" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="w02-download-spatial"><span class="header-section-number">2.4.4</span> Downloading spatial data</h3>
<p>We will start by downloading the administrative geography boundaries for England and Wales:</p>
<ol type="1">
<li>Navigate to the <em>Open Geography Portal</em>: <a href="https://geoportal.statistics.gov.uk/">[Link]</a></li>
<li>In the main menu go to <strong>Boundaries</strong> -&gt; <strong>Census Boundaries </strong> -&gt; <strong>Lower Layer Super Output Areas</strong> -&gt; <strong>2011 Boundaries</strong>.</li>
<li>Click on <strong>LSOA (Dec 2011) Boundaries Generalised Clipped BGC EW V3</strong>.</li>
<li>Click on <strong>Download</strong> -&gt; <strong>Download GeoPackage</strong>.</li>
</ol>
<p>Repeat the above process to also download the 2021 LSOA boundaries: <strong>Lower Layer Super Output Areas (2021) Boundaries EW BGC</strong>. Make sure you download the <strong>Generalised (20m)</strong> version.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Administrative geographies are a way of dividing the country into smaller sub-divisions or areas that correspond with the area of responsibility of local authorities and government bodies. These administrative sub-divisions and their associated geography have several important uses, including assigning electoral constituencies and serving as a mechanism for collecting Census data. These geographies are updated as populations evolve and as a result the boundaries of the administrative geographies are subject to either periodic or occasional change. <u>This is why we need to download both 2011 and 2021 LSOA boundaries.</u> More details on the administrative geographies of the UK can be found on the website of the <a href="https://www.ons.gov.uk/methodology/geography/ukgeographies/administrativegeography">Office for National Statistics</a>. On a different page they also explain the <a href="https://www.ons.gov.uk/methodology/geography/ukgeographies/censusgeographies/census2021geographies">Census 2021 geographies</a>, which include the LSOAs that we are using.</p>
</div>
</div>
</div>
<p>Now open your <code>GEOG0030/data/raw/</code> folder and create a new folder called <code>boundaries</code>. Rename the two files you just downloaded to <code>LSOA2011.gpkg</code> and <code>LSOA2021.gpkg</code>, respectively, and copy these into your <code>boundaries</code> folder.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You may have used spatial data before and noticed that we did not download a collection of files known as a <code>shapefile</code> but a <code>GeoPackage</code> instead. Whilst <code>shapefiles</code> are still being used, and you will most likely come across them at some point in your career if you have not already, the more modern, more portable, and open-source <code>GeoPackage</code> file format should be your spatial data format of choice where possible. Have a look at this article on <em>towardsdatascience.com</em> for an excellent explanation on why one should use <code>GeoPackage</code> files instead of <code>shapefiles</code>: <a href="https://towardsdatascience.com/why-you-need-to-use-geopackage-files-instead-of-shapefile-or-geojson-7cb24fe56416">[Link]</a></p>
</div>
</div>
</div>
</section>
<section id="w02-download-population" class="level3" data-number="1.4.5">
<h3 data-number="1.4.5" class="anchored" data-anchor-id="w02-download-population"><span class="header-section-number">2.4.5</span> Downloading population data</h3>
<p>For our population data, we will use the 2011 and 2021 Census population counts that are made available by the ONS through their <a href="https://www.nomisweb.co.uk/">Nomis</a> portal.</p>
<p>To get the 2011 Census population counts, you should:</p>
<ol type="1">
<li>Navigate to the <em>Nomis</em> portal: <a href="https://www.nomisweb.co.uk/">[Link]</a></li>
<li>Click on <strong>Query data</strong> in the <strong>Data Downloads</strong> panel.</li>
<li>Click on <strong>Census 2011</strong> -&gt; <strong>Key Statistics</strong>.</li>
<li>Click on <strong>KS101EW - Usual resident population</strong>.</li>
<li>Select <strong>Geography</strong> and set <strong>2011 super output areas - lower layer</strong> to <strong>All</strong>.</li>
<li>Click on <strong>Download data</strong> at the left hand side of the screen.</li>
<li>Once the data is ready for download, download the file to your computer.</li>
</ol>
<p>To get the 2021 Census population counts, you should:</p>
<ol type="1">
<li>Navigate to the <em>Nomis</em> portal: <a href="https://www.nomisweb.co.uk/">[Link]</a></li>
<li>Click on <strong>Query data</strong> in the <strong>Data Downloads</strong> panel.</li>
<li>Click on <strong>Census 2021</strong> -&gt; <strong>Topic Summaries</strong>.</li>
<li>Click on <strong>TS007A - Age by five-year age bands</strong>.</li>
<li>Select <strong>Geography</strong> and set <strong>2021 super output areas - lower layer</strong> to <strong>All</strong>.</li>
<li>Click on <strong>Download data</strong> at the left hand side of the screen.</li>
<li>Once the data is ready for download, download the file to your computer.</li>
</ol>
<p>In your <code>GEOG0030/data/raw/</code> folder, now create a new folder called <code>population</code> and copy the two Excel files to the newly created <code>population</code> folder. Rename the files you downloaded to: <code>LSOA2011_population.xlsx</code> and <code>LSOA2021_population.xlsx</code>, respectively.</p>
</section>
<section id="w02-cleaning" class="level3" data-number="1.4.6">
<h3 data-number="1.4.6" class="anchored" data-anchor-id="w02-cleaning"><span class="header-section-number">2.4.6</span> Cleaning data</h3>
<p>When you open up any of the LSOA spreadsheets in Excel, you will notice that some additional rows of information are contained at the top of each of these files. This extra information will confuse QGIS and we therefore need to do a bit of data cleaning. To reduce the chance of errors in later stages, we will also save the data in <code>csv</code> format.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><code>csv</code> stands for comma (or character) separated values. A <code>csv</code> file can be thought of as stripped-down Excel spreadsheet in which every column of data is separated by a comma. If you open a <code>csv</code> file within Excel, however, it will look ‘normal’. The advantage of using <code>csv</code> files is that it (should) make it easier to read data into QGIS and R as less things can go wrong. <code>csv</code> does have its limitations, especially when you are dealing with large datasets. A powerful and modern alternative is the <a href="https://parquet.apache.org/">parquet format</a>. For an introduction on how to use this, refer to Chapter 23 in Hadley Wickham’s <a href="https://r4ds.hadley.nz/arrow">R for Data Science (Second Edition)</a></p>
</div>
</div>
</div>
<section id="london-population-in-2011" class="level4">
<h4 class="anchored" data-anchor-id="london-population-in-2011">London population in 2011</h4>
<p>Open the <code>LSOA2011_population.xlsx</code> file in Excel. We have two main columns: one with identifying information that distinguishes each area from one another and one with population counts. In addition, there are some less informative rows at the top of the spreadsheet.</p>
<p>Looking at this we need to take three steps. First, we need to remove the top rows that we do not need. Second, we need to make sure that we extract all the rows with data that are relevant to <a href="https://en.wikipedia.org/wiki/Greater_London">Greater London</a>. Third, we need to spread the information in the first column into two columns. Currently, this columns contains unique area codes as well as unique area names. However, to be able to effectively link our population data to our spatial data, the codes are much more reliable and much less likely to cause issues than the area names. Putting area codes and area names into separate columns will help us sorting this out.</p>
<ol type="1">
<li>Open a new Excel spreadsheet. From the <code>LSOA2011_population.xlsx</code> spreadsheet, cut (<strong>Edit</strong> -&gt; <strong>Cut</strong>) all cells from columns <strong>A</strong> to <strong>B</strong> and rows <strong>9 to 4,651</strong> into this new spreadsheet. Row 4,651 denotes the end of the <u>majority</u> of the <em>Greater London</em> LSOAs.</li>
<li>Now we need to identify the missing LSOAs that were not kept at the top of the file with the other London LSOAs, probably because these LSOAs got introduced at a later point in time. Unfortunately, we can only do this manually by searching for the name of each of the London Boroughs and subsequently cutting the associated rows of data from the spreadsheet and pasting these into the second spreadsheet.</li>
<li>Go to <strong>Edit</strong> -&gt; <strong>Find</strong> -&gt; <strong>Find</strong>. Type in <strong>City of London</strong>. Cut (<strong>Edit</strong> -&gt; <strong>Cut</strong>) the two rows of data (<em>City of London 001F</em>, <em>City of London 001G</em>) and paste these at the bottom of the second spreadsheet.</li>
<li>Repeat this process to find all missing LSOAs by searching the names of all <strong>32</strong> London Boroughs.</li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You can make this process a bit less tedious by using keyboard shortcuts. On MacOS you can use: <code>cmd + f</code> to open up the find menu, <code>cmd + x</code> to cut data, and <code>cmd + v</code> to paste data. On Windows you can use: <code>ctrl + f</code> to open up the find menu, <code>ctrl + x</code> to cut data, and <code>ctrl + v</code> to paste date.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Not all of the <strong>32</strong> London Boroughs have missing LSOAs whilst in other cases the missing LSOAs are not grouped together (e.g.&nbsp;<em>Wandsworth</em> and <em>Southwark</em>) so after cutting the data, try <strong>Find</strong> again to make sure you did not miss any LSOAs. Once you are done cutting and pasting, you should have <strong>4,836</strong> rows of data in your second spreadsheet.</p>
</div>
</div>
</div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">London Boroughs</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Westminster</td>
<td style="text-align: left;">Sutton</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kensington and Chelsea</td>
<td style="text-align: left;">Crodyon</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hammersmith and Fulham</td>
<td style="text-align: left;">Bromley</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wandsworth</td>
<td style="text-align: left;">Lewisham</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lambeth</td>
<td style="text-align: left;">Greenwich</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southwark</td>
<td style="text-align: left;">Bexley</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tower Hamlets</td>
<td style="text-align: left;">Havering</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hackney</td>
<td style="text-align: left;">Barking and Dagenham</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Islington</td>
<td style="text-align: left;">Redbridge</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camden</td>
<td style="text-align: left;">Newham</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brent</td>
<td style="text-align: left;">Waltham Forest</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ealing</td>
<td style="text-align: left;">Haringey</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hounslow</td>
<td style="text-align: left;">Enfield</td>
</tr>
<tr class="even">
<td style="text-align: left;">Richmond upon Thames</td>
<td style="text-align: left;">Barnet</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kingston upon Thames</td>
<td style="text-align: left;">Harrow</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merton</td>
<td style="text-align: left;">Hillingdon</td>
</tr>
</tbody>
</table>
<ol start="5" type="1">
<li>Once you copied all the rows of data, rename the columns in the new spreadsheet to <code>lsoa</code> and <code>pop2011</code>, respectively.</li>
<li>Cut all the data from the <code>pop2011</code> column that is stored in column <strong>B</strong> and paste these into column <strong>C</strong>. You now should have a column <em>without</em> any data between the <code>lsoa</code> and <code>pop2011</code> columns.</li>
<li>Highlight the entire <code>lsoa</code> column and in the <strong>Data</strong> menu click on the <strong>Text to Columns</strong> menu button.</li>
</ol>
<div class="cell" data-hash="02-GIScience_cache/html/fig-text-to-columns_71503eede84db16bc68b6f0c0bd6a134">
<div class="cell-output-display">
<div id="fig-text-to-columns" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/text-to-columns.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Highlight the <code>lsoa</code> columns and find the <strong>Text to Columns</strong> menu option. Note that column <strong>B</strong> does not contain any data. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/text-to-columns.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Note that the <strong>Text to Columns</strong> function might be elsewhere in the menu depending on your version of Excel and/or your operating system.</p>
</div>
</div>
</div>
<ol start="8" type="1">
<li>In the <strong>Text to Columns</strong> menu, select the <strong>Delimited</strong> radio button and click <strong>Next</strong>.</li>
<li>Uncheck the checkbox for <strong>Tab</strong> and put <code>:</code> (colon) into the <strong>Other</strong> box. Click <strong>Finish</strong>.</li>
<li>Change the name of the <code>lsoa</code> column to <code>lsoa11_code</code> and change the name of the now populated column <strong>B</strong> to <code>lsoa11_name</code>.</li>
</ol>
<div class="cell" data-hash="02-GIScience_cache/html/fig-almost-there_8fefaa2af6941f7fe3704379ff912b39">
<div class="cell-output-display">
<div id="fig-almost-there" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/almost-there.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Your spreadsheet should now look something like this. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/almost-there.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<ol start="11" type="1">
<li>One thing that might cause problems when we try to link the population data to the spatial data is that there are still spaces contained in the <code>lsoa11_code</code> column. This is not directly noticeable as these spaces are <code>white space</code> characters at the end of the LSOA codes without any other characters following it (i.e.&nbsp;<a href="https://stackoverflow.com/questions/22273233/what-is-meant-by-trailing-space-and-whats-the-difference-between-it-and-a-blank">trailing spaces</a>). This may seem trivial, but we need this column later and computer language is very precise so we need to remove these. We can do this by highlighting the entire <code>lsoa11_code</code> column and in the <strong>Home</strong> menu opting for <strong>Replace</strong> under the <strong>Find &amp; Select</strong> menu.</li>
</ol>
<div class="cell" data-hash="02-GIScience_cache/html/fig-find-replace_fddda475374065c5a634b451c74a62b3">
<div class="cell-output-display">
<div id="fig-find-replace" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/find-replace.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Accessing the <strong>Replace</strong> option. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/find-replace.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<ol start="12" type="1">
<li>In the <strong>Find what</strong> box put in a singular <code>white space</code>, using the <em>spacebar</em> on your keyboard, keep the <strong>Replace with</strong> box empty, and click on <strong>Replace all</strong>. You should get a message that <strong>4,835</strong> replacements have been made.</li>
<li>One further bit of formatting that you must do before saving your data is to format our population field. At the moment, you will see that there are commas separating the thousands within our values. If we leave these commas in our values, QGIS will read them as decimal points, creating decimal values of our population. There are many points at which we could resolve this issue, but the easiest point is now - we will strip our population values of the commas and set them to integer (whole numbers) values. To format the <code>pop2011</code> column, highlight the entire column and right-click on the <code>C</code> cell. Click on <strong>Format Cells</strong> and set the cells to <strong>Number</strong> with <strong>0</strong> decimal places. You should see that the commas are now removed from your population values.</li>
<li>Save your spreadsheet as a <code>csv</code> file into your <code>data</code> folder as <code>LSOA2011_population.csv</code>.</li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>After saving the file, Excel might give you a warning along the lines of <em>Possible data loss</em>. You can safely ignore this message as the only ‘information’ you have lost is markup information (e.g.&nbsp;fonts, colours, items in bold, etc.) or formulas within Excel (e.g.&nbsp;if you used Excel formulas to calculate <em>means</em>, <em>medians</em>, etc.). In some cases you might also have options to choose what type of <code>csv</code> you would want to save the spreadsheet as. If so, opt for something along the lines of <code>CSV UTF-8 (Comma-delimited) (.csv)</code>.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Depending on the language settings of your operating system (e.g.&nbsp;Windows, MacOS, Linux) and language settings, <code>csv</code> files might use a different character instead of a comma. This may seem trivial, but it can cause issues when reading the data into a different programme. It is therefore always a good idea to check your <code>csv</code> file in a plain text editor (e.g.&nbsp;<strong>Textedit</strong> on MacOS or <strong>Notepad</strong> on Windows). In case you do not see commas (<code>,</code>), but semicolons (<code>;</code>) you can apply a <u>quick and dirty</u> fix to your data by <em>finding and replacing</em> every <code>;</code> with a <code>,</code> in the same that way we fixed our problematic <code>white space</code> characters in Excel.</p>
</div>
</div>
</div>
</section>
<section id="london-population-in-2021" class="level4">
<h4 class="anchored" data-anchor-id="london-population-in-2021">London population in 2021</h4>
<p>Now the 2011 data is prepared, we can move to the 2021 data:</p>
<ol type="1">
<li>Open the <code>LSOA2021_population.xlsx</code> in Excel. You will notice that the file is formatted largely the same as the <code>LSOA2011_population.xlsx</code> file, although if you were to look closely you will notice that the majority of London data are not at the top this time but that Local Authority Districts are grouped together - and in fact all data pertaining to Greater London are also grouped together. This makes our lives much easier because we can now simply cut the data for each of the <strong>32</strong> Boroughs and <em>City of London</em> in one go.</li>
<li>Open a new Excel spreadsheet. From the <code>LSOA2021_population.xlsx</code> spreadsheet, cut (<strong>Edit</strong> -&gt; <strong>Cut</strong>) all cells from columns <strong>A</strong> to <strong>B</strong> and rows <strong>19,790 to 2,4783</strong> and paste these into this new spreadsheet.</li>
<li>Take the remaining steps to prepare the 2021 population steps: split the <code>lsoa</code> column, remove the trailing <code>white space</code> characters from the LSOA code column, and remove the decimal commas in the population count column.</li>
<li>Save the file as <code>csv</code> into your <code>data</code> folder as <code>LSOA2021_population.csv</code> with the following column names: <code>lsoa21_code</code>, <code>lsoa21_name</code>, and <code>pop2021</code>.</li>
</ol>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Again make sure you did not miss any LSOAs. You should end up with <strong>4,995</strong> rows of data in your second spreadsheet.</p>
</div>
</div>
</div>
</section>
</section>
<section id="mapping-population-data" class="level3" data-number="1.4.7">
<h3 data-number="1.4.7" class="anchored" data-anchor-id="mapping-population-data"><span class="header-section-number">2.4.7</span> Mapping population data</h3>
<section id="setting-up-a-project" class="level4">
<h4 class="anchored" data-anchor-id="setting-up-a-project">Setting up a project</h4>
<p>We will now use QGIS to create population maps for the LSOAs in London for both years. To achieve this, we need to <strong>join our table data to our spatial datasets</strong> and then map our populations for our visual analysis.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Due to the differences in the LSOA boundaries between 2011 and 2021, we can only make a visual comparison between the two years. You will notice that data interoperability is a key issue that you will face in spatial analysis, particularly when it comes to working with Administrative Geographies.</p>
</div>
</div>
</div>
<ol type="1">
<li>Start <strong>QGIS</strong>.</li>
<li>Click on <strong>Project</strong> -&gt; <strong>New</strong>. Save your project as <code>w2-pop-analysis</code>. Remember to save your work throughout the practical.</li>
<li>Before we get started with adding data, we will first set the Coordinate Reference System of our Project. Click on <strong>Project</strong> -&gt; <strong>Properties – CRS</strong>. In the Filter box, type <strong>British National Grid</strong>. Select <strong>OSGB 1936 / British National Grid - EPSG:27700</strong> and click Apply. Click <strong>OK</strong>.</li>
</ol>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We will explain CRSs and using CRSs in GIS software in more detail next week. For now all you need to know is that the CRS makes sure that the data we plot on the map are plotted in the correct location.</p>
</div>
</div>
</div>
</section>
<section id="adding-spatial-data" class="level4">
<h4 class="anchored" data-anchor-id="adding-spatial-data">Adding spatial data</h4>
<p>Now are project is set up, we can start by loading our 2011 spatial layer.</p>
<ol type="1">
<li>Click on <strong>Layer</strong> -&gt; <strong>Add Layer</strong> -&gt; <strong>Add Vector Layer</strong>.</li>
<li>With <strong>File</strong> as your source type, click on the small three dots button and navigate to your 2011 boundary files.</li>
<li>Here, we will select the <code>LSOA2011.gpkg</code> dataset. Highlight the file and click <strong>Open</strong>. Then click <strong>Add</strong>. You may need to close the box after adding the layer. The 2011 LSOA geography for England and Wales should now be loaded.</li>
</ol>
<div class="cell" data-hash="02-GIScience_cache/html/fig-england-wales_602fdbd99512fb775c82d626569b80e6">
<div class="cell-output-display">
<div id="fig-england-wales" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/england-wales.png" class="img-fluid figure-img" width="776"></p>
<figcaption class="figure-caption">Figure&nbsp;5: 2011 LSOAs for England and Wales. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/england-wales.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="conducting-an-attribute-join" class="level4">
<h4 class="anchored" data-anchor-id="conducting-an-attribute-join">Conducting an attribute join</h4>
<p>We are now going to join our 2011 population data to our 2011 spatial data file. We start by adding the 2011 population data to our project.</p>
<ol type="1">
<li>Click on <strong>Layer</strong> -&gt; <strong>Add Layer</strong> -&gt; <strong>Add Delimited Text Layer</strong>.</li>
<li>Click on the three dots button again and navigate to your <strong>2011 population data</strong> in your <code>data</code> folder. Your file format should be set to <code>csv</code>. You should have the following boxes clicked under the <strong>Record and Field options</strong> menu: <code>Decimal separator is comma</code>, <code>First record has field names</code>, <code>Detect field types</code> and <code>Discard empty fields</code>. QGIS does many of these by default, but do double-check.</li>
<li>Set the Geometry to <em>No geometry (attribute only table)</em> under the <strong>Geometry Definition</strong> menu. Then click <strong>Add</strong> and <strong>Close</strong>. You should now see a table added to your <code>Layers</code> pane.</li>
</ol>
<p>We can now join this table data to our spatial data using an <strong>Attribute Join</strong>.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>An <strong>Attribute Join</strong> is one of two types of data joins you will use in spatial analysis (the other is a <strong>Spatial join</strong>, which we will look at later on in the module). An attribute join essentially allows you to link two datasets together, as long as they share a common attribute to facilitate the ‘matching’ of rows:</p>
<div class="cell" data-hash="02-GIScience_cache/html/fig-join-those-attributes_47fe56706ac466a006b9f0f82991a60c">
<div class="cell-output-display">
<div id="fig-join-those-attributes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/attribute-joins.png" class="img-fluid figure-img" width="435"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Attribute Joins. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/attribute-joins.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Essentially you need a <strong>single unique identifying</strong> (UID) field for your records within both datasets: this can be a code, a name or any other string of information. In spatial analysis, we always join our table data to our spatial data. One way to think about it as attaching the table data to the spatial data layer.</p>
<p>To make a join work, you need to make sure your ID field is correct across both datasets, i.e.&nbsp;no typos or spelling mistakes. Computers can only follow instructions, so they do not know that <em>St.&nbsp;Thomas</em> in one dataset is the same as <em>St Thomas</em> in another.</p>
<p>As a result, whilst in our datasets we have kept both the name and code for both the boundary data and the population data, when creating the join, we will always prefer to use the code over their names. Unlike names, codes reduce the likelihood of error and mismatch because they do not rely on understanding spelling. Common errors, such as adding in spaces or using <code>0</code> instead <code>O</code> (and vice versa) can still happen but it is less likely.</p>
</div>
</div>
</div>
<p>To make our join work, we need to check that we have a matching <strong>UID</strong> across both our datasets. We therefore need to look at the tables of both datasets and check what attributes we have that could be used for this possible match.</p>
<ol start="4" type="1">
<li>Open up the <strong>Attribute Tables</strong> of each layer and check what fields we have that could be used for the join. We can see that both our respective ‘code’ fields have the same codes (<code>LSOA11CD</code> and <code>lsoa11_code</code>) which seem to contain the same type of information.</li>
<li>Right-click on your <code>LSOA2011</code> spatial layer, click on <strong>Properties</strong> and then click on the <strong>Joins</strong> tab.
<ul>
<li>Click on the <strong>+</strong> button. Make sure the <strong>Join Layer</strong> is set to <code>LSOA2011_population</code>.</li>
<li>Set the <strong>Join field</strong> to <code>lsoa11_code</code>.</li>
<li>Set the <strong>Target field</strong> to <code>LSOA11CD</code>.</li>
<li>Click the <strong>Joined Fields</strong> box and click to only select the <code>pop2011</code> field.</li>
<li>Click on the <strong>Custom Field Name Prefix</strong> and <strong>remove</strong> the pre-entered text to leave it blank.</li>
<li>Click on <strong>OK</strong>.</li>
<li>Click on <strong>Apply</strong> in the main Join tab and then click <strong>OK</strong> to return to the main QGIS window.</li>
</ul></li>
</ol>
<p>We can now check to see if our join has worked by opening up the <strong>Attribute Table</strong> of our <code>LSOA11CD</code> spatial layer and looking to see if our LSOAs now have a <strong>Population</strong> field attached to it.</p>
<ol start="6" type="1">
<li>Sort the data in the <strong>Attribute Table</strong> on the <code>pop2011</code> field by clicking on the column name: all LSOAs for which we have population data (i.e.&nbsp;only the London LSOAs) are now grouped at the top of the file. Select the first <strong>4,835</strong> rows of data.</li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You can select the first row, scroll down to the last row that has population data, hold down the <code>shift</code> button on your keyboard, and click on the last row that has population data to select all rows that we need in one go.</p>
</div>
</div>
</div>
<div class="cell" data-hash="02-GIScience_cache/html/fig-select-london_4f7d73f742097a383d8627e91334a251">
<div class="cell-output-display">
<div id="fig-select-london" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/select-london.png" class="img-fluid figure-img" width="690"></p>
<figcaption class="figure-caption">Figure&nbsp;7: All <strong>4,835</strong> London LSOAs selected. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/select-london.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<ol start="7" type="1">
<li>Close the <strong>Attribute Table</strong>. Right-click on the <code>LSOA2011</code> layer and select <strong>Export</strong> -&gt; <strong>Save Selected Features As</strong>. Set <strong>Format</strong> to <code>GeoPackage</code> and click on the small three dots button next to <strong>File name</strong> and navigate to your <code>data/raw/boundaries</code> folder. Save the file as <code>LSOA2011_London.gpkg</code>.</li>
<li>You can now untick the <code>LSOA2011</code> containing all the LSOAs for England and Wales. Right-click on the <code>LSOA2011_London</code> layer and click on <strong>Zoom to Layer(s)</strong>.</li>
</ol>
<div class="cell" data-hash="02-GIScience_cache/html/fig-lsoa-london_e03b0189d26bcf231007cb8a56a59dfc">
<div class="cell-output-display">
<div id="fig-lsoa-london" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/all-lsoa-london.png" class="img-fluid figure-img" width="776"></p>
<figcaption class="figure-caption">Figure&nbsp;8: All <strong>4,835</strong> London LSOAs. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/all-lsoa-london.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The main strength of a GUI GIS system is that is really helps us understand how spatial data relate to one another and are visualised. Even with just two spatial layers loaded, we can understand two key concepts of using spatial data within GIS. The first, and this is only really relevant to GUI GIS systems, is that each layer can either be turned on or off, to make it visible or not. The second concept is the order in which your layers are drawn – and this is relevant for both GUI GIS and when using plotting libraries such as <code>ggplot2</code> or <code>tmap</code> in RStudio. Your layers will be drawn depending on the order in which your layers are either tabled (as in a GUI GIS) or ‘called’ in your function in code. Being aware of this need for ‘order’ is important when we shift to using RStudio and <code>tmap</code> to plot our maps, as if you do not layer your data correctly in your code, your map will end up not looking as you hoped. For us using QGIS right now, the layers will be drawn from bottom to top.</p>
</div>
</div>
</div>
<p>We can now finally map the population distribution of London in 2011.</p>
<ol start="9" type="1">
<li>Right-click on the <code>LSOA2011_London</code> layer and click on <strong>Properties</strong> -&gt; <strong>Symbology</strong>.
<ul>
<li>In the dropdown menu at the top of the window, select <strong>Graduated</strong> as symbology.</li>
<li>Under <strong>Value</strong> choose <code>pop2011</code> as your column.</li>
<li>We can then change the color ramp to suit our aesthetic preferences. In the <strong>Colour ramp</strong> dropdown menu select <em>Magma</em>.</li>
<li>The final thing we need to do is <strong>classify</strong> our data - what this simply means is to decide how to group the values in our dataset together to create the graduated representation. We will be looking at classification options in later weeks, but for now, we will use the <strong>Natural Breaks</strong> option. Open the drop-down menu next to <strong>Mode</strong>, select <strong>Natural Breaks</strong>, change it to <strong>7</strong> classes and then click <strong>Classify</strong>.</li>
<li>Finally click <strong>Apply</strong> to style your dataset.</li>
</ul></li>
</ol>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Understanding what classification is appropriate to visualise your data is an important step within spatial analysis and visualisation, and something you will learn more about in the following weeks. Overall, they should be determined by looking at the distribution of the underlying data.</p>
</div>
</div>
</div>
<p>You should now be looking at something like this:</p>
<div class="cell" data-hash="02-GIScience_cache/html/fig-lsoa-pop-2011_ff784f882bdce5ffdedf5d98a948dcaa">
<div class="cell-output-display">
<div id="fig-lsoa-pop-2011" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/w02/lsoa-population-2011.png" class="img-fluid figure-img" width="776"></p>
<figcaption class="figure-caption">Figure&nbsp;9: The population distribution of London in 2011. <a href="https://jtvandijk.github.io/GEOG0030/images/w02/lsoa-population-2011.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Whereas the above map is <u>fine for today</u>, it is technically incorrect because we are showing <u>absolute</u> numbers on a choropleth. This is something we should <strong>never</strong> do, unless the spatial units are identical in size (e.g.&nbsp;a hexagonal tessellation of an area), because larger areas will draw attention and affect the visualisation.</p>
</div>
</div>
</div>
</section>
</section>
<section id="exporting-map-for-visual-analysis" class="level3" data-number="1.4.8">
<h3 data-number="1.4.8" class="anchored" data-anchor-id="exporting-map-for-visual-analysis"><span class="header-section-number">2.4.8</span> Exporting map for visual analysis</h3>
<p>To export your map select only the map layers you want to export and then opt for <strong>Project</strong> -&gt; <strong>Import/Export</strong> -&gt; <strong>Export to Image</strong> and save your final map in your <code>output</code> folder. Next week, we will look at how to style our maps using the main map conventions (adding North Arrows, Scale Bars and Legends, etc.) but for now a simple output will do.</p>
</section>
</section>
<section id="assignment-w02" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="assignment-w02"><span class="header-section-number">2.5</span> Assignment</h2>
<p>You now need to <strong>repeat the entire process</strong> to also create a map for the 2021 Census data. Remember, you need to:</p>
<ul>
<li>Load the respective spatial layer.</li>
<li>Load the respective population dataset.</li>
<li>Join the two datasets together using an <strong>Attribute Join</strong>.</li>
<li>Export your joined dataset (London only) as a <code>GeoPackage</code> and save this into your <code>data</code> folder as <code>LSOA2011_London.gpkg</code>. <u>We will use this file in later weeks.</u></li>
<li>Style your data appropriately.</li>
<li>Export your maps as an image to your <code>output</code> folder.</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>To make visual comparisons against our two datasets, theoretically we would need to standardise the breaks at which our classification schemes are set at. To set all two datasets to the same breaks, you can do the following:</p>
<ul>
<li>Right-click again on the <code>LSOA2011_London</code> dataset and, click on <strong>Styles</strong> -&gt; <strong>Copy Styles</strong> -&gt; <strong>Symbology</strong>.</li>
<li>Now right-click on the <code>LSOA2021_London</code> file, and click on <strong>Styles</strong> -&gt; <strong>Paste Style</strong> -&gt; <strong>Symbology</strong>. You should now see the classification breaks in the 2021 dataset change to match those in the 2011 data.</li>
<li>The final thing you need to do is to change the classification column in the <code>Symbology</code> tab for the 2021 dataset to reflect <code>pop2021</code>.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="byl-w02" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="byl-w02"><span class="header-section-number">2.6</span> Before you leave</h2>
<p>Save your project so you can go back to it if you need to, other than that <a href="https://www.youtube.com/watch?v=Wmc8bQoL-J0">that is it for this week</a>!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-introduction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Geocomputation: An Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-cartography.html" class="pagination-link">
        <span class="nav-page-text">Cartography and Visualisation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Course material by <a href="https://www.mappingdutchman.com">Justin van Dijk</a>. Available under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>